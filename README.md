# FFmpeg 批量转码脚本 (Windows 批处理版本)

这是一个简易的 FFmpeg 批量视频转码脚本，提供多种常用的参数配置，含硬件加速选项。

## 作者在用的 FFmpeg 版本下载链接：

[Windows builds from gyan.dev latest release-full version: 8.0](https://www.gyan.dev/ffmpeg/builds/ffmpeg-release-full.7z)

## 注意
启动前请将input文件夹中的.gitkeep（占位文件）删除

使用过程中有任何bug都请提出，我会尽快修复

## 功能特性

- 🎯 **多格式支持**: 支持 H.264、HEVC/H.265 和 AV1 编解码转换
- ⚡ **硬件加速**: 支持 NVIDIA、Intel 和 AMD 显卡的硬件编解码
- 🎨 **灵活配置**: 可自定义分辨率、码率、编码配置文件和像素格式
- 🔊 **音视频处理**: 支持音频和字幕流的自定义处理参数
- 📁 **批量处理**: 自动处理输入目录中的所有文件
- 📊 **进度统计**: 提供详细的处理结果统计

## 系统要求

- Windows 操作系统
- 已安装 FFmpeg 并添加到系统 PATH
- 支持的显卡（如使用硬件加速功能）

## 使用方法

### 1. 准备工作

1. 将需要转码的视频文件放入 `input` 文件夹
2. 确保已安装正确版本的 FFmpeg

### 2. 运行脚本

双击运行批处理文件，按照提示进行配置：

#### 第一步：选择源文件编码格式
- 1) H.264
- 2) HEVC/H.265  
- 3) AV1

#### 第二步：选择解码方式
- 1) CPU 软件解码（兼容性最好）
- 2) NVIDIA 显卡硬件解码（CUVID）
- 3) Intel 显卡硬件解码（QSV）
- 4) AMD 显卡硬件解码（暂未测试）

#### 第三步：选择目标编码格式
- 1) H.264
- 2) HEVC/H.265
- 3) AV1

#### 第四步：选择编码方式
- 1) CPU 软编码（兼容性好，速度慢）
- 2) NVIDIA 显卡硬件编码（NVENC）
- 3) Intel 显卡硬件编码（QSV）
- 4) AMD 显卡硬件编码（暂未测试）

#### 第五步：选择编码配置
- 1) main（8位色彩）
- 2) high（8位色彩）
- 3) high10（10位色彩，仅 H.264）
- 4) main10（10位色彩，仅 HEVC）

#### 第六步：分辨率设置
- 可选择保持原始分辨率或自定义分辨率

#### 第七步：码率配置
- 设置目标码率、最高码率和缓冲区大小

#### 第八步：音频和字幕处理
- 自定义音频流处理参数（如最常用的复制流 `-c:a copy`）
- 自定义字幕流处理参数（如最常用的复制流 `-c:s copy`）

### 3. 开始处理

确认所有设置后，脚本将开始批量处理输入目录中的所有视频文件。

## 目录结构

```
脚本所在目录/
│
├── ffmpeg_batch.bat    # 主脚本文件
├── input/              # 输入目录（自动创建）
│   └── *.video          # 待处理视频文件
└── output/             # 输出目录（自动创建）
    └── *.video          # 处理后的视频文件
```

## 注意事项

1. **硬件兼容性**: 不同显卡的编解码能力不同，请根据实际硬件选择
2. **色彩深度**: 10位配置需要相应的硬件和编解码器支持
3. **文件格式**: 脚本处理输入目录中的所有文件，请确保文件格式正确
4. **资源占用**: 硬件加速可显著提高速度，但仍需足够的系统资源
5. **错误处理**: 脚本会记录成功和失败的文件数量，便于排查问题

## 故障排除

如果遇到问题：
1. 检查 FFmpeg 是否正确安装
2. 确认硬件支持所选编解码选项
3. 查看错误信息调整参数设置
4. 确保输入文件格式正确且可读

## 许可证

此脚本采用 MIT 许可证开源，可自由使用和修改。

---

*提示：使用前建议使用 MediaInfo 等工具查看源文件的详细编码信息，以便做出更准确的选择。*
